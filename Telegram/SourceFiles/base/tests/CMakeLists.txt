add_executable(tests_flags flags_tests.cpp)
target_link_libraries(tests_flags Qt5::Core)
add_test(NAME flagsTest COMMAND tests_flags)

add_executable(tests_flat_map flat_map_tests.cpp)
target_link_libraries(tests_flat_map Qt5::Core)
add_test(NAME flatMapTest COMMAND tests_flat_map)

add_executable(tests_flat_set flat_set_tests.cpp)
target_link_libraries(tests_flat_set Qt5::Core)
add_test(NAME flatSetTest COMMAND tests_flat_set)


add_executable(tests_emojis tests_emojis.cpp
    $<TARGET_PROPERTY:Kepka,BINARY_DIR>/emoji.cpp
    $<TARGET_PROPERTY:Kepka,BINARY_DIR>/emoji_suggestions_data.cpp
    # man, half part of tdesktop, bleat'.
    $<TARGET_PROPERTY:Kepka,SOURCE_DIR>/SourceFiles/ui/emoji_config.cpp
    $<TARGET_PROPERTY:Kepka,SOURCE_DIR>/ThirdParty/emoji_suggestions/emoji_suggestions.cpp
    # damned emojis wants logs. DO NOT WANT. STUB IT.
    # $<TARGET_PROPERTY:Kepka,SOURCE_DIR>/SourceFiles/logs.cpp

)

# force UTF-8 on MSVC or else test will fail.
if (MSVC)
    target_compile_options(tests_emojis PRIVATE "/utf-8")
endif()

# For autogenerated emoji.h
# target_compile_definitions(tests_emojis PRIVATE TDESKTOP_DISABLE_CRASH_REPORTS)
target_include_directories(tests_emojis PRIVATE $<TARGET_PROPERTY:Kepka,BINARY_DIR>)
target_link_libraries(tests_emojis Qt5::Core Qt5::GuiPrivate Qt5::Widgets) # Qt5::Network)
add_test(NAME emojisTest COMMAND tests_emojis)
